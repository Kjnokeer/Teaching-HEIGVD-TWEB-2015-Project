<!DOCTYPE html>
<html class='no-js' lang='en'>
  <head>
    <meta charset='utf-8'>
    <meta content='IE=edge,chrome=1' http-equiv='X-UA-Compatible'>
    <title>MaMaThiVa - Answer poll</title>
    <meta content='lab2023' name='author'>
    <meta content='' name='description'>
    <meta content='' name='keywords'>
    <link href="assets/stylesheets/application-a07755f5.css" rel="stylesheet" type="text/css" />
    <link href="assets/stylesheets/font-awesome.min.css" rel="stylesheet" type="text/css" />
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="assets/images/logo_t.png" rel="icon" type="image/ico" />
    
  </head>

  <body class='login' ng-app="AudienceApp">
    <div class='wrapper' >
      <div class='row'>
        <div class='col-lg-12'>
          <div class='brand text-center'>
            <h1>
              <div class='logo-icon'>
                <i><img src="assets/images/logo_t.png" width="55px" style="margin-left: -6px; margin-top: -6px;"></i>
              </div>
              MaMaThiVa
            </h1>
            <h4>Answer a poll :</h4>
          </div>
        </div>
      </div>
      <div class='row' ui-view ng-controller="audienceController">
        <div class='col-lg-12'>
          <form ng-submit="audience()">
            <div class='form-group'>
              <input type="text" name="pollnr" id="pollnr" class="form-control" placeholder="Poll number" ng-model="poll.number"></input>
            </div>
            <div class='form-group'>
              <input type="text" name="pseudo" id="pseudo" class="form-control" placeholder="Pseudo" ng-model="poll.pseudo"></input>
            </div>
            <div class='text-center'>
                <!--<button type="submit" class="btn btn-default">Continue</button>-->
                <button class="btn btn-default">Continue</a>
            </div>
          </form>
        </div>
      </div>
    </div>
    <!-- Footer -->
    <!-- Javascripts -->
    <script src="js/jquery/jquery.min.js"></script>
    <script src="js/angular/angular.min.js"></script>
    <script src="js/angular/angular-ui-router.js"></script>
    <script src="assets/javascripts/jquery-ui.min.js" type="text/javascript"></script>
    <script src="assets/javascripts/modernizr.min.js" type="text/javascript"></script>
    <script src="assets/javascripts/application-9e04b2b6.js" type="text/javascript"></script>

    <script>
      angular.module("AudienceApp", ["ui.router"])
       .config(function($stateProvider) {

       $stateProvider.state('audience', {
          templateUrl: 'partials/audience/audience.html',
          url: '/audience'
       });

       $stateProvider.state('polls', {
          templateUrl: 'partials/audience/question.html',
          url: '/audience/:pollNr'
       });

       $stateProvider.state('error', {
          templateUrl: 'partials/audience/error.html',
          url: '/error'
       });

      })
      .controller('audienceController', function($scope, $http, $state){

        $scope.poll = {
          number: "",
          pseudo: ""
        };

        $scope.audience = function(){
          //$scope.pseudo

          //$http.get('/audience/poll', $scope.pollnr).then(success, error);

          $http.get('127.0.0.1:3000/api/polls/' + $scope.poll.number, success, error);

          function success(response) {
            console.log("success");
            $state.go("polls", {"pollNr": response.data._id});
          }

          function error(response){
            console.log("error");
            //$state.go("error");
          }

        }
      });
    </script>
  </body>
</html>
